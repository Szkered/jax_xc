"""Generated from {{ name }}.mpl."""

import jax
import jax.numpy as jnp
from jax.numpy import array as array
from jax.numpy import int32 as int32
from jax.numpy import nan as nan
from typing import Callable

{% if additional %}
from ._helper import {{ additional }}
{% endif %}

{% if type == "lda" %}
def pol(r0, r1, params, p):
{% elif type == "gga" %}
def pol(r0, r1, s0, s1, s2, params, p):
{% elif type == "mgga" %}
def pol(r0, r1, s0, s1, s2, l0, l1, tau0, tau1, params, p):
{% endif %}
  {{ pol_code | indent(2) }}
  return res

{% if type == "lda" %}
def unpol(r0, params, p):
{% elif type == "gga" %}
def unpol(r0, s0, params, p):
{% elif type == "mgga" %}
def unpol(r0, s0, l0, tau0, params, p):
{% endif %}
  {{ unpol_code | indent(2) }}
  return res
